# 機械学習を利用した大気のゆらぎのゆらぎの補正技術の開発
- 木星の画像（動画）を、CNN、U-net、Noise2Noise、affine変換を使用して大気の揺らぎを補正するアプリを、Pythonをメインで開発しています。

## 使用技術
### 開発関係
- Python
    - pytorch
    - numpy
    - opencv
    - flet(GUI実装)
- uv

## uv(仮想環境とパッケージ管理)のおおまかな使い方
| コマンド   | 説明   | 用途・タイミング   | 例   |
|------------|----------------------------------------------------------------------|---------------------------------------------------|-------------------------------------|
| `uv sync`  | `pyproject.toml` に基づいて依存関係を同期し、ロックファイルを生成。 | 初回セットアップ、依存の更新時                   | `uv sync`                           |
| `uv run`   | 仮想環境内でコマンドを実行。pythonファイルを後ろにくっつけると、そのファイルを実行                                         | 依存をインストールせずにスクリプトを実行したい時 | `uv run python app.py`             |
| `uv add`   | パッケージを追加し、`pyproject.toml` とロックファイルを更新。       | 新しい依存をプロジェクトに追加したいとき         | `uv add requests`                  |

### Python3.9で作成してください。（バージョンはいずれ上げる予定）

## ./srcフォルダについて
### Modules
- 自作モジュール（importで読み込むやつ）を格納するフォルダ
- 単体で実行した場合も、デモコードが実行される

- noise2noise.py
    - Noise2Noise(Noise_to_Noise)を実装したコード
    - U-Netを使用している
    - [U-Netとは | スキルアップAI Journal](https://www.skillupai.com/blog/tech/segmentation2/)
- ellipse.py
    - アフィン変換（回転、拡大縮小、平行移動）によって楕円補正を試みたやつ
- generate_movie.py
  - 画像の入ったフォルダから、動画を生成するコード
  - 星グル写真のタイムラプスをイメージするとわかりやすいかも
- hsv_low_high.ipynb
  - hsvによる木星の模様検出を試みた、jupyter notebook用のファイル
  - 普通に開くととてつもなく見にくいため、Google Colab上で、閲覧すること推奨
- hsv.py
  - 上のファイルをモジュール化したもの
  - なぜか両方とも結果が違う
- sift.py
  - 特徴点抽出、特徴点マッチングを利用した楕円補正
  - ホモグラフィー変換を使用するため、特徴点マッチングがうまくいかないと失敗する
  - hsv.pyと組み合わせることを想定
  - 簡単なノイズ除去をするクラスも同梱
- ML/affine_image_correction_r1.py
  - 強化学習による、楕円補正の実装（開発中）
  - 2つの画像のシャープネスを測定し、値がいいほうにもう片方を補正する
- ML/image_sharpness.py
  - 使用してないはず（AIに丸々実装させたからわからん）

##＃ mainフォルダについて
- これらのモジュールを使用して、実際にコードを実装したコードを格納するフォルダ

- movie_denoise.py
  - Modules/noise2noise.pyを使用し、フォルダ内のすべての画像ファイルをノイズ除去する
  - ノイズ除去された連番画像から動画ファイルが生成される
- movie_affine.py
  - Modules/ellipse.pyを使用し、フォルダ内のすべての画像ファイルにアフィン変換を適用する





---
このプロジェクトは [MIT License](LICENSE) のもとで公開されています。
また、本プロジェクトで利用しているサードパーティ製ライブラリやパッケージのライセンス情報は、リポジトリ内の「licenses/THIRD_PARTY」ディレクトリに記載されています。各ライブラリのライセンス詳細については、そちらをご参照ください。
